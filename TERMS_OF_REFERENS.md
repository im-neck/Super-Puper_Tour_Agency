# Техническое задание на разработку информационной системы туристического агентства  
**«Супер Пупер Тур Агентство»**

## 1. Введение

### 1.1. Назначение системы
Информационная система «Супер Пупер Тур Агентство» предназначена для автоматизации процессов подбора, бронирования и управления туристическими турами. Система обеспечивает взаимодействие между клиентами туристического агентства и менеджерами, а также предоставляет инструменты администрирования и учета заказов.

### 1.2. Цели создания
* Упрощение процесса поиска и бронирования туров для клиентов.
* Централизованное хранение информации о турах, клиентах и заказах.
* Автоматизация расчёта стоимости тура и контроля статусов бронирований.

---

## 2. Функциональные требования

### 2.1. Ролевая модель
Система должна поддерживать следующие роли пользователей:

1. **Клиент (Client)**  
   Просматривает туры, оформляет бронирование, просматривает историю заказов.

2. **Менеджер (Manager)**  
   Обрабатывает заявки клиентов, подтверждает бронирования, изменяет статусы туров.

3. **Администратор (Admin)**  
   Управляет справочниками (туры/направления), пользователями и ценовой политикой.

---

### 2.2. Сценарии использования (Use Cases)

#### Для Клиента:
* **Регистрация и авторизация** — вход по email и паролю.
* **Поиск тура** — фильтрация по стране/городу, датам, длительности, бюджету, типу питания, количеству звёзд отеля.
* **Просмотр тура** — описание, цена, даты, условия, включённые услуги, сведения об отеле (в составе тура).
* **Бронирование тура** — создание заявки на выбранный тур.
* **Отмена бронирования** — возможна до подтверждения менеджером.
* **Просмотр истории заказов** — список бронирований с их статусами.

#### Для Менеджера:
* **Просмотр заявок** — список новых и активных бронирований.
* **Подтверждение бронирования** — перевод заявки в статус «Confirmed».
* **Отмена бронирования** — перевод заявки в статус «Cancelled» с указанием причины.


#### Для Системы:
* **Автоотмена заявки** — если заявка не подтверждена менеджером в течение заданного времени, перевод в статус «Cancelled».

---

## 3. Требования к данным (Инфологическая модель)

Для проектирования базы данных необходимо предусмотреть следующие сущности:

1. **Users (Пользователи)**  
   **ID**, Email, Хеш пароля, Роль, ФИО, Телефон, Дата регистрации.

2. **Tours (Туры)**  
   **ID**, Название, Страна, Город,  
   Дата начала, Дата окончания, Длительность (дней),  
   Цена (базовая), Валюта, Описание,  
   Отель (Название), Категория отеля (звёзды), Тип питания,  
   Что включено (перелёт/трансфер/страховка и т.п. — текст),  
   Статус (*Available, Unavailable*).

3. **Bookings (Бронирования)**  
   **ID**, ID Пользователя, ID Тура,  
   Дата создания, Итоговая стоимость, Комментарий клиента (опционально),  
   Статус (*Created, Confirmed, Cancelled*),  
   Комментарий менеджера/причина отмены (опционально).

---

## 4. Требования к интерфейсам

Система должна предоставлять REST API. Примерные эндпоинты:

* `POST /api/auth/register` — регистрация
* `POST /api/auth/login` — авторизация (получение JWT токена)

* `GET /api/tours` — поиск туров (фильтры через query params)
* `GET /api/tours/{id}` — информация о туре
* `POST /api/tours` — создание тура (для Admin)

* `POST /api/bookings` — создание бронирования
* `GET /api/bookings/my` — бронирования текущего пользователя
* `PUT /api/bookings/{id}/cancel` — отмена бронирования клиентом (до подтверждения)

* `GET /api/manager/bookings` — список заявок (для менеджера)
* `PUT /api/bookings/{id}/status` — изменение статуса (для менеджера)

---

## 5. Нефункциональные требования и архитектура

### 5.1. Стек технологий
* Язык реализации: **Python**
* Backend: **FastAPI** (или Flask)
* База данных: **PostgreSQL** (или SQLite для учебной версии)
* ORM: **SQLAlchemy**
* Аутентификация: **JWT**

### 5.2. Надежность и безопасность
* Пароли пользователей должны храниться в виде хеша (например, bcrypt/argon2).
* Методы API, изменяющие данные, должны требовать авторизацию (Bearer JWT).
* Доступ к менеджерским методам должен быть ограничен ролью **Manager/Admin**.

### 5.3. Требования к разработке
* Структура проекта по слоям: API (роуты), сервисы (бизнес-логика), модели (ORM), схемы (DTO).
* Конфигурация (строка подключения к БД, секрет JWT) через переменные окружения.
* Возможность расширения: добавление оплаты, отзывов, промокодов, интеграций.
